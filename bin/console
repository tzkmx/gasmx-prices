#!/usr/bin/env php
<?php
require __DIR__ . '/../vendor/autoload.php';

use Symfony\Component\Console\Application;
use GasmxPricesUpdate\Command\GasmxPricesUpdate\GasmxPricesUpdateCommand;
use Pimple\Container;
use GasmxPricesUpdate\Provider\HttpClientProvider;

$c = new Container([
        'maps_api_key' => getenv('MAPS_API_KEY'),
]);

$c['cache.path'] = realpath(__DIR__ . '/../var/cache');

$c->register(new HttpClientProvider());

$c['console.app'] = function($c) {
    $app = new Application('Gasmx Prices Update', '1.0');
    $app->add($c['gasmx.prices.update']);
    return $app;
};
$c['gasmx.prices.update'] = function($c) {
    return new GasmxPricesUpdateCommand($c);
};

$c['console.app']->run();
